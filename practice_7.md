# Урок 7. Управление пакетами и репозиториями.Основы сетевой безопасности

## 1. Подключить репозиторий с nginx любым удобным способом, установить nginx и потом удалить nginx, используя утилиту dpkg.
Узнаю версию `Ubuntu`:
```console
duckluckbreakout@ubuntuserver:~$ lsb_release -a
No LSB modules are available.
Distributor ID:	Ubuntu
Description:	Ubuntu 20.04 LTS
Release:	20.04
Codename:	focal
```
Подключение репозитория:
```console
root@ubuntuserver:/etc/apt/sources.list.d# echo "deb http://nginx.org/packages/ubuntu focal nginx" > nginx.list
root@ubuntuserver:/etc/apt/sources.list.d# curl -fsSL https://nginx.org/keys/nginx_signing.key | sudo apt-key add -
OK
root@ubuntuserver:/etc/apt/sources.list.d# sudo apt update
root@ubuntuserver:/etc/apt/sources.list.d# sudo apt install nginx -y
```
## 2. Установить пакет на свой выбор, используя snap.
```console
duckluckbreakout@ubuntuserver:/etc/apt/sources.list.d$ sudo snap install robomongo
robomongo 0.9.0-rc9 from Francesco Banconi (frankban) installed
```
## 3. Настроить iptables: разрешить подключения только на 22-й и 80-й порты.
```console
duckluckbreakout@ubuntuserver:/etc/apt/sources.list.d$ sudo iptables -P INPUT DROP
```
Тут я слишком поздно осознал последствия данной команды, из-за чего пришлось исправлять напрямую в терминале виртуалки:
```console
root@ubuntuserver:~# iptables -A INPUT -p tcp --dport 22 -j ACCEPT
```
Вернув доступ по ssh открыл порт `80`:
```console
duckluckbreakout@ubuntuserver:~$ sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
sudo: unable to resolve host ubuntuserver: Temporary failure in name resolution
[sudo] password for duckluckbreakout: 
duckluckbreakout@ubuntuserver:~$ iptables-save
Failed to list table names in /proc/net/ip_tables_names: Permission denied
duckluckbreakout@ubuntuserver:~$ sudo iptables-save
sudo: unable to resolve host ubuntuserver: Temporary failure in name resolution
# Generated by iptables-save v1.8.4 on Wed Aug 12 17:42:25 2020
*filter
:INPUT DROP [9:628]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [51:4876]
-A INPUT -p tcp -m tcp --dport 22 -j ACCEPT
-A INPUT -p tcp -m tcp --dport 80 -j ACCEPT
COMMIT
# Completed on Wed Aug 12 17:42:25 2020
```
Исправление появившегося `sudo: unable to resolve host ubuntuserver: Temporary failure in name resolution`:
```console
duckluckbreakout@ubuntuserver:~$ sudo vim /etc/hosts
sudo: unable to resolve host ubuntuserver: Temporary failure in name resolution
```
Почему-то `ubuntuserver` было заменено на `ubuntu_server`:
[![imageup.ru](https://imageup.ru/img215/3640896/screenshot-from-2020-08-12-20-46-04.png)](https://imageup.ru/img215/3640896/screenshot-from-2020-08-12-20-46-04.png.html)

Исправляю обратно на `ubuntuserver`:
[![imageup.ru](https://imageup.ru/img169/3640898/screenshot-from-2020-08-12-20-46-18.png)](https://imageup.ru/img169/3640898/screenshot-from-2020-08-12-20-46-18.png.html)

Проверка:
```console
duckluckbreakout@ubuntuserver:~$ sudo -i
root@ubuntuserver:~# 
```
